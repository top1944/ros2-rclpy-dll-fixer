# 一键修复rclpy - 使用前必读

## ⚙️ 环境变量设置

在使用本工具包之前，**必须**设置 `ROS2_HOME` 环境变量。

### 方法1：临时设置（推荐）

在命令行中运行：

```batch
set ROS2_HOME=C:\dev\ros2_humble
```

或者，如果您的ROS2安装在其他位置，请相应修改路径。

### 方法2：永久设置

1. 右键"此电脑" → "属性"
2. "高级系统设置" → "环境变量"
3. 在"系统变量"中新建：
   - 变量名：`ROS2_HOME`
   - 变量值：`C:\dev\ros2_humble`（根据您的实际安装路径修改）

---

## 🚀 快速开始

### 1. 设置环境变量

```batch
set ROS2_HOME=C:\dev\ros2_humble
```

### 2. 运行修复工具

**新手用户：**
```batch
fix_rclpy_dll_simple.bat
```

**高级用户：**
```batch
python 一键修复rclpy.py
```

---

## 📁 文件说明

### 执行文件
- `fix_rclpy_dll_simple.bat` - 批处理修复工具（双击运行）
- `一键修复rclpy.py` - Python修复工具（命令行运行）
- `fix_rclpy_dll_deps.py` - DLL依赖分析工具

### 文档文件
- `README.md` - 本工具包的入口文档
- `ROS2_DLL修复README.md` - 完整文档导航
- `快速修复指南.md` - 新手快速入门
- `ROS2_rclpy_DLL修复教程.md` - 详细技术教程
- `使用说明.md` - 常见问题解答
- `使用前必读.md` - 本文件

---

## ✅ 验证设置

运行以下命令验证环境变量是否正确设置：

```batch
echo %ROS2_HOME%
```

应该显示您的ROS2安装路径，例如：
```
C:\dev\ros2_humble
```

---

## ❓ 常见问题

### Q: 忘记设置ROS2_HOME怎么办？

**A:** 工具会尝试自动搜索常见路径，但建议显式设置环境变量以避免问题。

### Q: ROS2安装在不同位置？

**A:** 修改环境变量为您的实际路径，例如：
```batch
set ROS2_HOME=D:\my_ros2\ros2_humble
```

### Q: 运行修复工具后提示找不到ROS2目录？

**A:** 检查以下内容：
1. ROS2_HOME环境变量是否正确
2. 该路径是否存在
3. 该路径是否是有效的ROS2安装目录

---

## 🎯 典型使用流程

### 场景1：首次使用
```batch
# 1. 设置环境变量
set ROS2_HOME=C:\dev\ros2_humble

# 2. 运行修复工具
fix_rclpy_dll_simple.bat

# 3. 按照提示操作
```

### 场景2：开发ROS2 Python节点
```batch
# 1. 设置环境变量
set ROS2_HOME=C:\dev\ros2_humble
set PATH=%ROS2_HOME%\bin;%PATH%

# 2. 运行您的ROS2节点
python my_node.py
```

### 场景3：每次使用都设置环境变量
创建批处理文件 `run_ros2.bat`:
```batch
@echo off
set ROS2_HOME=C:\dev\ros2_humble
set PATH=%ROS2_HOME%\bin;%PATH%
set PYTHONPATH=%ROS2_HOME%\Lib\site-packages;%PYTHONPATH%
python %1
```

使用：
```batch
run_ros2.bat my_node.py
```

---

## 💡 提示

1. **环境变量优先级**：工具会优先使用 `ROS2_HOME` 环境变量
2. **路径格式**：Windows路径建议使用反斜杠 `\` 或正斜杠 `/`
3. **永久设置**：如果您经常使用ROS2，建议将 `ROS2_HOME` 添加到系统环境变量
4. **多版本ROS2**：如果安装了多个ROS2版本，可以每次使用前切换 `ROS2_HOME`

---

## 📞 获取帮助

如果遇到问题：

1. 查看 `使用说明.md` 的常见问题部分
2. 阅读 `ROS2_rclpy_DLL修复教程.md` 的故障排除章节
3. 运行 `fix_rclpy_dll_deps.py` 进行详细诊断

---

**版本**: v1.0
**更新日期**: 2026-02-23
**适用**: ROS2 Humble + Python 3.10 + Windows 10/11
